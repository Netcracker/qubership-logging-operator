# This filter generates a Prometheus metric that counts the number of log records
# which failed to be parsed (i.e., records where the "parsed" field is not "true").
#
# Parameters:
# - match_regex: (pods|klog).*
#   Applies this filter only to records with tags matching "pods.*" or "klog.*", like in filter-validate.conf
#
# - kubernetes_mode: on
#   Adds Kubernetes metadata (such as pod_name, namespace_name, container_name, etc.)
#
# - Regex: parsed (?!true)
#   Only records where the "parsed" field is not "true" (or is missing) will be counted.
[FILTER]
    name               log_to_metrics
    match_regex        (pods|klog).*
    tag                parse_error_metrics
    metric_mode        counter
    metric_name        parse_error_total
    metric_description Total number of parse errors
    kubernetes_mode    on
    Regex              parsed (?!true)
